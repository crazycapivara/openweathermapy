<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Openweathermapy - Python OpenWeatherMap.org API 2.5 Wrapper">
        <meta name="author" content="Stefan Kuethe">
        
        <link rel="shortcut icon" href="./img/favicon.ico">

	<title>Openweathermapy</title>

        <link href="./css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="./css/highlight.css">
        <link href="./css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href=".">Openweathermapy</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="active">
                    <a href=".">Home</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li class="disabled">
                    <a rel="next" >
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li class="disabled">
                    <a rel="prev" >
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/crazycapivara/openweathermapy">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#openweathermapy">Openweathermapy</a></li>
        
    
        <li class="main "><a href="#overview">Overview</a></li>
        
    
        <li class="main "><a href="#status">Status</a></li>
        
    
        <li class="main "><a href="#version">Version</a></li>
        
    
        <li class="main "><a href="#changelog">Changelog</a></li>
        
    
        <li class="main "><a href="#requirements">Requirements</a></li>
        
    
        <li class="main "><a href="#installation">Installation</a></li>
        
    
        <li class="main "><a href="#getting-started">Getting started</a></li>
        
            <li><a href="#data-objects">Data objects</a></li>
        
            <li><a href="#views">Views</a></li>
        
            <li><a href="#fetch-current-weather-data">Fetch current weather data</a></li>
        
            <li><a href="#fetch-forecast-data">Fetch forecast data</a></li>
        
            <li><a href="#fetch-historical-data">Fetch historical data</a></li>
        
    
        <li class="main "><a href="#pandas-support">Pandas support</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="openweathermapy">Openweathermapy</h1>
<p>Python package wrapping <strong>OpenWeatherMap.org's</strong> API 2.5.</p>
<hr />
<h1 id="overview">Overview</h1>
<p>As <strong>OpenWeatherMap.org</strong> returns data mostly in the form of nested dictionaries,
<strong>Openweathermapy</strong> gives a simple API to access items in a comfortable way:</p>
<pre><code class="python"># classic access
item = data[&quot;main&quot;][&quot;temp&quot;]

# openweathermapy access
item = data(&quot;main.temp&quot;)

# access multiple items at once
&gt;&gt;&gt; items = data(&quot;main.temp&quot;, &quot;wind.speed&quot;)
</code></pre>

<hr />
<h1 id="status">Status</h1>
<p>Development Beta</p>
<hr />
<h1 id="version">Version</h1>
<p>0.7.0</p>
<hr />
<h1 id="changelog">Changelog</h1>
<ul>
<li><strong>2015-08-09</strong> optional <code>pandas.DataFrame</code> support added for forecast and historical data</li>
</ul>
<hr />
<h1 id="requirements">Requirements</h1>
<p><strong>Openweathermapy</strong> supports Python 2.7, 3.2, 3.3 and 3.4. There are no more requirements,
but for forecast and historical data <code>pandas.DataFrame</code> objects can be returned.
So it is cool to install <strong>Pandas</strong> as well but it is not madatory. </p>
<hr />
<h1 id="installation">Installation</h1>
<pre><code class="bash"># via pip
~$ pip install openweathermapy

# or download package and run ...
~$ python setup.py install
</code></pre>

<hr />
<h1 id="getting-started">Getting started</h1>
<pre><code class="Python">&gt;&gt;&gt; import openweathermapy.core as owm
</code></pre>

<p>All parameters defined in <strong>OpenWeatherMap.org's</strong> API documentation can be passed to the functions
in <strong>Openweathermapy</strong> as keyword arguments <code>**params</code>.
The query string always depends on the request (API call), but unsupported parameters will  not raise an error.
Most common ones to be used are <code>units</code>, <code>lang</code> and (if needed) <code>APPID</code>. So it may be a good idea to pass them
in the form of a settings dictionary:</p>
<pre><code class="Python">&gt;&gt;&gt; settings = {&quot;units&quot;: &quot;metric&quot;, &quot;lang&quot;: &quot;DE&quot;}
&gt;&gt;&gt; data = owm.get_current(&quot;Kassel,DE&quot;, **settings)

# settings containing APIKEY
&gt;&gt;&gt; settings = {&quot;APPID&quot;: 1111111111, &quot;units&quot;: &quot;metric&quot;}
</code></pre>

<h2 id="data-objects">Data objects</h2>
<p>The main data object is <code>openweathermapy.utils.NestedDict</code>, which extends Python's builtin <code>dict</code> 
by methods giving a more flexible access to the items as shown above. If a list of weather data (objects) is returned
<code>openweathermapy.utils.NestedDictList</code> or <code>openweathermapy.core.DataBlock</code> is used. The latter one just adds
an attribute <code>meta</code> to the <code>NestedDictList</code> containing the meta data of the responses:</p>
<pre><code class="python"># get current weather data (data point)
&gt;&gt;&gt; data = owm.get_current(&quot;Kassel,DE&quot;)
&gt;&gt;&gt; type(data)
openweathermapy.utils.NestedDict

# get forecast data (data block)
&gt;&gt;&gt; data = owm.get_forecast_daily(&quot;London,UK&quot;)
&gt;&gt;&gt; type(data)
openweathermapy.core.DataBlock

&gt;&gt;&gt;type(data.meta)
openweathermapy.utils.NestedDict
</code></pre>

<h2 id="views">Views</h2>
<p>A <strong>view</strong> is just a list of keys to extract data from the responses. So, you can define views like <strong>summary</strong>,
<strong>minimal</strong> etc. depending on your needs. This keeps everything as flexible as possible:</p>
<pre><code class="Python">&gt;&gt;&gt; views = {
...    &quot;summary&quot;: [&quot;main.temp&quot;, &quot;main.pressure&quot;, &quot;main.humidity&quot;]
... }

&gt;&gt;&gt; data = owm.get_current(&quot;London,UK&quot;, units=&quot;metric&quot;)
&gt;&gt;&gt; data(*views[&quot;summary&quot;])
(18.56, 1011, 63)

# return complete keys
&gt;&gt;&gt; data.get_dict(views[&quot;summary&quot;])
{'main.temp': 18.56, 'main.humidity': 63, 'main.pressure': 1011}

# return only last key
&gt;&gt;&gt; data.get_dict(views[&quot;summary&quot;], split_keys=True)
{'pressure': 1011, 'temp': 18.56, 'humidity': 63} 
</code></pre>

<p>You can also load views from files in <strong>json</strong> format for example by using <code>openweathermapy.utils.load_config</code>.</p>
<h2 id="fetch-current-weather-data">Fetch current weather data</h2>
<p>The <code>city</code> argument can be given as <strong>name</strong>, <strong>id</strong>, or <strong>geographic coordinates</strong>.
If you want to stay as close as possible to the original API, you can also skip the
first argument and use the parameters <code>q</code>, <code>id</code>, <code>lat</code> and <code>lon</code> or <code>zip</code> instead,
for details see <strong>OpenWeatherMap.org's</strong> API documentation:</p>
<pre><code class="Python"># get data by city name and country code
&gt;&gt;&gt; data = owm.get_current(&quot;Kassel,DE&quot;)

# get data by city id and set language to german (DE)
&gt;&gt;&gt; data = owm.get_current(2892518, lang=&quot;DE&quot;)

# get data by latitude and longitude and return temperatures in Celcius
&gt;&gt;&gt; location = (51.32, 9.5)
&gt;&gt;&gt; data = owm.get_current(location, units=&quot;metric&quot;)

# optional: skip city argument and get data by zip code
&gt;&gt;&gt; data = owm.get_current(zip=&quot;34128,DE&quot;) 

# access single item
&gt;&gt;&gt; data(&quot;main.temp&quot;)
11.06

# access multiple items at once
&gt;&gt;&gt; keys = [&quot;main.temp&quot;, &quot;main.humidity&quot;, &quot;wind.speed&quot;]
&gt;&gt;&gt; data.get_many(keys)
(11.06, 58, 6.2)

# alternative access
&gt;&gt;&gt; data(*keys)
(11.06, 58, 6.2)

# get data for 'Kassel,DE', 'Malaga,ES', 'New York,US'
&gt;&gt;&gt; city_ids = (2892518, 2514256, 5128581)
&gt;&gt;&gt; data = owm.get_current_for_group(city_ids, units=&quot;metric&quot;, lang=&quot;DE&quot;)
&gt;&gt;&gt; data_malaga = data[1]

# find city by name and return data for match(es)
&gt;&gt;&gt; data = owm.find_city(&quot;Malaga&quot;)

# get data for 5 cities around geographic coordinates
&gt;&gt;&gt; location = (51.32, 9.5)
&gt;&gt;&gt; data = owm.find_cities_by_geo_coord(location, 5)

# get data from station
&gt;&gt;&gt; data = owm.get_current_from_station(4926)

# get stations by geographic coordinates
&gt;&gt;&gt; location = (51.32, 9.5)
&gt;&gt;&gt; data = owm.find_stations_by_geo_coord(location)
</code></pre>

<h2 id="fetch-forecast-data">Fetch forecast data</h2>
<p>The <code>city</code> can be given in the same way as shown in the examples above.  </p>
<pre><code class="Python"># get 3h forecast data
&gt;&gt;&gt; data = owm.get_forecast_hourly(&quot;Kassel,DE&quot;, lang=&quot;DE&quot;)

# get daily forecast data for 7 days
&gt;&gt;&gt; data = owm.get_forecast_daily(&quot;Kassel,DE&quot;, 7, units=&quot;metric&quot;)

# show meta data
&gt;&gt;&gt; data.meta
{u'city': {u'country': u'DE', u'population': 0, u'id': 2892518,
u'coord': {u'lat': 51.316669, u'lon': 9.5}, u'name': u'Kassel'},
u'message': 0.0185, u'cod': u'200', u'cnt': 7}

# get coordinates and id
&gt;&gt;&gt; data.meta(&quot;city.coord&quot;, &quot;city.id&quot;)
({u'lat': 51.316669, u'lon': 9.5}, 2892518)

# select columns
&gt;&gt;&gt; selection = data.select([&quot;dt&quot;, &quot;temp.min&quot;, &quot;temp.max&quot;])
&gt;&gt;&gt; for line in selection:
...    line 
...
(1437044400, 16.63, 24.99)
(1437130800, 18.21, 30.17)
(1437217200, 14.96, 26.35)
(1437303600, 15.82, 23.49)
(1437390000, 15.52, 23.95)
(1437476400, 18.77, 29.11)
(1437562800, 14.67, 27.11)

# convert column &quot;dt&quot; to datetime string
&gt;&gt;&gt; from datetime import datetime as dt
&gt;&gt;&gt; conv = {&quot;dt&quot;: lambda ts: str(dt.utcfromtimestamp(ts))}

&gt;&gt;&gt; selection = data.select([&quot;dt&quot;, &quot;temp.min&quot;, &quot;temp.max&quot;], converters=conv)
&gt;&gt;&gt; for line in selection:
...    line 
...
('2015-07-16 11:00:00', 16.63, 24.99)
('2015-07-17 11:00:00', 18.21, 30.17)
('2015-07-18 11:00:00', 14.96, 26.35)
('2015-07-19 11:00:00', 15.82, 23.49)
('2015-07-20 11:00:00', 15.52, 23.95)
('2015-07-21 11:00:00', 18.77, 29.11)
('2015-07-22 11:00:00', 14.67, 27.11)
</code></pre>

<h2 id="fetch-historical-data">Fetch historical data</h2>
<p>For a complete list of parameters, which can be passed,
please refer to <strong>OpenWeatherMap.org's</strong> API documention. </p>
<pre><code class="Python"># get historical data by city name
&gt;&gt;&gt; data = owm.get_history(&quot;Kassel,DE&quot;)

# define time period
&gt;&gt;&gt; from datetime import datetime as dt
&gt;&gt;&gt; date_s = dt(2015, 4, 1).timestamp()
&gt;&gt;&gt; date_e = dt(2015, 4, 6).timestamp()

# get historical data for given time period by city id
&gt;&gt;&gt; data = owm.get_history(2892518, start=date_s, end=date_e)

# give start date and number of hours to be retured
&gt;&gt;&gt; data = owm.get_history(&quot;London,UK&quot;, start=date_s, cnt=48)

# get historical data from station
&gt;&gt;&gt; data = owm.get_history_from_station(4926)
</code></pre>

<h1 id="pandas-support">Pandas support</h1>
<p><strong>Since Openweathermapy version 0.7.0</strong></p>
<p>For forecast and historical data it is possible to get <code>pandas.DataFrame</code> objects from the responses:</p>
<pre><code class="python">&gt;&gt;&gt; data = owm.get_forecast_daily(&quot;London,UK&quot;)

# keys will be used as column names
&gt;&gt;&gt; selection = data.select_pandas([&quot;dt&quot;, &quot;main.temp&quot;, &quot;wind.speed&quot;])
&gt;&gt;&gt; selection.set_index(&quot;dt&quot;)

# it is also possible to pass an index column to the function
&gt;&gt;&gt; dates = data.get(&quot;dt&quot;)
&gt;&gt;&gt; selection = data.select_pandas([&quot;main.temp&quot;, &quot;wind.speed&quot;], index=dates)

&gt;&gt;&gt; selection.to_csv()
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>Copyright 2015 Stefan Kuethe</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="./js/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap-3.0.3.min.js"></script>
        <script src="./js/highlight.pack.js"></script>
        <script src="./js/base.js"></script>
    </body>
</html>